.......................F....F.............F.......F....FF...FF.......    [100%]
================================== FAILURES ===================================
_______________________ test_dependency_multi_leg_chain _______________________

    def test_dependency_multi_leg_chain():
        """
        Complex: Sell EUR -> SGD -> Buy USD.
        """
        portfolio = PortfolioSnapshot(
            portfolio_id="pf_chain",
            base_currency="SGD",
            positions=[
                Position(instrument_id="EUR_ASSET", quantity=Decimal("10")),  # 10*100 = 1000 EUR
            ],
            cash_balances=[CashBalance(currency="SGD", amount=Decimal("0.0"))],
        )
    
        # Swap EUR Asset for USD Asset
        model = ModelPortfolio(
            targets=[
                ModelTarget(instrument_id="EUR_ASSET", weight=Decimal("0.0")),
                ModelTarget(instrument_id="USD_ASSET", weight=Decimal("1.0")),
            ]
        )
    
        shelf = [
            ShelfEntry(instrument_id="EUR_ASSET", status="APPROVED"),
            ShelfEntry(instrument_id="USD_ASSET", status="APPROVED"),
        ]
    
        market_data = MarketDataSnapshot(
            prices=[
                Price(instrument_id="EUR_ASSET", price=Decimal("100.0"), currency="EUR"),
                Price(instrument_id="USD_ASSET", price=Decimal("100.0"), currency="USD"),
            ],
            fx_rates=[
                FxRate(pair="EUR/SGD", rate=Decimal("1.5")),  # 1000 EUR -> 1500 SGD
                FxRate(pair="USD/SGD", rate=Decimal("1.3")),  # Need ~1153 USD
            ],
        )
    
        result = run_simulation(portfolio, market_data, model, shelf, EngineOptions())
    
        # Intents: Sell EUR_ASSET, Buy USD_ASSET, FX Sell EUR, FX Buy USD
        # Fixed F841: removed unused assignment 'sell_sec'
>       buy_sec = next(i for i in result.intents if i.instrument_id == "USD_ASSET")

tests\test_dependencies.py:140: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\test_dependencies.py:140: in <genexpr>
    buy_sec = next(i for i in result.intents if i.instrument_id == "USD_ASSET")
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = FxSpotIntent(intent_type='FX_SPOT', intent_id='oi_fx_3', pair='EUR/SGD', buy_currency='SGD', buy_amount=Decimal('1500....R', sell_amount_estimated=Decimal('1000.0'), dependencies=[], rationale=IntentRationale(code='SWEEP', message='Sweep'))
item = 'instrument_id'

    def __getattr__(self, item: str) -> Any:
        private_attributes = object.__getattribute__(self, '__private_attributes__')
        if item in private_attributes:
            attribute = private_attributes[item]
            if hasattr(attribute, '__get__'):
                return attribute.__get__(self, type(self))  # type: ignore
    
            try:
                # Note: self.__pydantic_private__ cannot be None if self.__private_attributes__ has items
                return self.__pydantic_private__[item]  # type: ignore
            except KeyError as exc:
                raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc
        else:
            # `__pydantic_extra__` can fail to be set if the model is not yet fully initialized.
            # See `BaseModel.__repr_args__` for more details
            try:
                pydantic_extra = object.__getattribute__(self, '__pydantic_extra__')
            except AttributeError:
                pydantic_extra = None
    
            if pydantic_extra is not None:
                try:
                    return pydantic_extra[item]
                except KeyError as exc:
                    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc
            else:
                if hasattr(self.__class__, item):
                    return super().__getattribute__(item)  # Raises AttributeError if appropriate
                else:
                    # this is the current error
>                   raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
E                   AttributeError: 'FxSpotIntent' object has no attribute 'instrument_id'. Did you mean: 'intent_id'?

venv\Lib\site-packages\pydantic\main.py:767: AttributeError
_____________________ test_target_normalization_over_100 ______________________

base_context = (PortfolioSnapshot(portfolio_id='pf_1', base_currency='USD', positions=[], cash_balances=[CashBalance(currency='USD', ...ional=None), ShelfEntry(instrument_id='SELL_ONLY_ASSET', status='SELL_ONLY', asset_class='EQUITY', min_notional=None)])

    def test_target_normalization_over_100(base_context):
        """Target Logic: Weights summing > 100% should be scaled down."""
        pf, mkt, shelf = base_context
        model = ModelPortfolio(
            targets=[
                ModelTarget(instrument_id="AAPL", weight=Decimal("0.8")),
                ModelTarget(instrument_id="DBS", weight=Decimal("0.8")),
            ]
        )
    
        result = run_simulation(pf, mkt, model, shelf, EngineOptions())
    
        # Total 1.6 -> Scaled to 0.5 each
        # AAPL: 100k * 0.5 / 150 = 333
        # DBS: 100k * 0.5 / (30/1.35) = 2250
    
>       assert result.status == "PENDING_REVIEW"  # Scaled implies review
E       AssertionError: assert 'BLOCKED' == 'PENDING_REVIEW'
E         
E         - PENDING_REVIEW
E         + BLOCKED

tests\test_engine_core.py:147: AssertionError
_________ test_golden_scenario[scenario_03_fx_funding.json-scenario2] _________

filename = 'scenario_03_fx_funding.json'
scenario = {'expected_outputs': {'after_simulated': {'allocation': [], 'cash_balances': [{'amount': '4955.05000', 'currency': 'SG...: None, 'settled': None}], 'portfolio_id': 'pf_003', 'positions': []}, ...}, 'scenario_name': 'scenario_03_fx_funding'}

    @pytest.mark.parametrize("filename, scenario", load_golden_scenarios())
    def test_golden_scenario(filename, scenario):
        inputs = scenario["inputs"]
        portfolio = PortfolioSnapshot(**inputs["portfolio_snapshot"])
        market_data = MarketDataSnapshot(**inputs["market_data_snapshot"])
        model = ModelPortfolio(**inputs["model_portfolio"])
        shelf = [ShelfEntry(**s) for s in inputs["shelf_entries"]]
        options = EngineOptions(**inputs["options"])
    
        if "error" in scenario["expected_outputs"]:
            with pytest.raises(ValueError, match=scenario["expected_outputs"]["error"]):
                run_simulation(portfolio, market_data, model, shelf, options)
        else:
            result = run_simulation(portfolio, market_data, model, shelf, options)
            expected = scenario["expected_outputs"]
    
            assert result.status == expected["status"]
            assert len(result.intents) == len(expected["intents"])
    
            for act_intent, exp_intent in zip(result.intents, expected["intents"]):
>               assert act_intent.side == exp_intent["side"]

tests\test_golden_scenarios.py:46: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = FxSpotIntent(intent_type='FX_SPOT', intent_id='oi_fx_2', pair='USD/SGD', buy_currency='USD', buy_amount=Decimal('3737....ell_amount_estimated=Decimal('5044.95000'), dependencies=[], rationale=IntentRationale(code='FUNDING', message='Fund'))
item = 'side'

    def __getattr__(self, item: str) -> Any:
        private_attributes = object.__getattribute__(self, '__private_attributes__')
        if item in private_attributes:
            attribute = private_attributes[item]
            if hasattr(attribute, '__get__'):
                return attribute.__get__(self, type(self))  # type: ignore
    
            try:
                # Note: self.__pydantic_private__ cannot be None if self.__private_attributes__ has items
                return self.__pydantic_private__[item]  # type: ignore
            except KeyError as exc:
                raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc
        else:
            # `__pydantic_extra__` can fail to be set if the model is not yet fully initialized.
            # See `BaseModel.__repr_args__` for more details
            try:
                pydantic_extra = object.__getattribute__(self, '__pydantic_extra__')
            except AttributeError:
                pydantic_extra = None
    
            if pydantic_extra is not None:
                try:
                    return pydantic_extra[item]
                except KeyError as exc:
                    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc
            else:
                if hasattr(self.__class__, item):
                    return super().__getattribute__(item)  # Raises AttributeError if appropriate
                else:
                    # this is the current error
>                   raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
E                   AttributeError: 'FxSpotIntent' object has no attribute 'side'

venv\Lib\site-packages\pydantic\main.py:767: AttributeError
_____ test_golden_scenario[scenario_104_multicurrency_fx.json-scenario10] _____

filename = 'scenario_104_multicurrency_fx.json'
scenario = {'expected_outputs': {'after_simulated': {'allocation': [{'key': 'US_ETF', 'value': {'amount': '19980.000', 'currency'... 'settled': None}], 'portfolio_id': 'pf_104', 'positions': []}, ...}, 'scenario_name': 'scenario_104_multicurrency_fx'}

    @pytest.mark.parametrize("filename, scenario", load_golden_scenarios())
    def test_golden_scenario(filename, scenario):
        inputs = scenario["inputs"]
        portfolio = PortfolioSnapshot(**inputs["portfolio_snapshot"])
        market_data = MarketDataSnapshot(**inputs["market_data_snapshot"])
        model = ModelPortfolio(**inputs["model_portfolio"])
        shelf = [ShelfEntry(**s) for s in inputs["shelf_entries"]]
        options = EngineOptions(**inputs["options"])
    
        if "error" in scenario["expected_outputs"]:
            with pytest.raises(ValueError, match=scenario["expected_outputs"]["error"]):
                run_simulation(portfolio, market_data, model, shelf, options)
        else:
            result = run_simulation(portfolio, market_data, model, shelf, options)
            expected = scenario["expected_outputs"]
    
            assert result.status == expected["status"]
            assert len(result.intents) == len(expected["intents"])
    
            for act_intent, exp_intent in zip(result.intents, expected["intents"]):
>               assert act_intent.side == exp_intent["side"]

tests\test_golden_scenarios.py:46: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = FxSpotIntent(intent_type='FX_SPOT', intent_id='oi_fx_2', pair='USD/SGD', buy_currency='USD', buy_amount=Decimal('14948...ll_amount_estimated=Decimal('20179.80000'), dependencies=[], rationale=IntentRationale(code='FUNDING', message='Fund'))
item = 'side'

    def __getattr__(self, item: str) -> Any:
        private_attributes = object.__getattribute__(self, '__private_attributes__')
        if item in private_attributes:
            attribute = private_attributes[item]
            if hasattr(attribute, '__get__'):
                return attribute.__get__(self, type(self))  # type: ignore
    
            try:
                # Note: self.__pydantic_private__ cannot be None if self.__private_attributes__ has items
                return self.__pydantic_private__[item]  # type: ignore
            except KeyError as exc:
                raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc
        else:
            # `__pydantic_extra__` can fail to be set if the model is not yet fully initialized.
            # See `BaseModel.__repr_args__` for more details
            try:
                pydantic_extra = object.__getattribute__(self, '__pydantic_extra__')
            except AttributeError:
                pydantic_extra = None
    
            if pydantic_extra is not None:
                try:
                    return pydantic_extra[item]
                except KeyError as exc:
                    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc
            else:
                if hasattr(self.__class__, item):
                    return super().__getattribute__(item)  # Raises AttributeError if appropriate
                else:
                    # this is the current error
>                   raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
E                   AttributeError: 'FxSpotIntent' object has no attribute 'side'

venv\Lib\site-packages\pydantic\main.py:767: AttributeError
__ test_golden_scenario[scenario_112_cross_currency_switch.json-scenario15] ___

filename = 'scenario_112_cross_currency_switch.json'
scenario = {'expected_outputs': {'after_simulated': {'allocation': [{'key': 'US_TECH', 'value': {'amount': '0.00', 'currency': 'S...d': 'US_TECH', 'market_value': None, 'quantity': '100'}]}, ...}, 'scenario_name': 'scenario_112_cross_currency_switch'}

    @pytest.mark.parametrize("filename, scenario", load_golden_scenarios())
    def test_golden_scenario(filename, scenario):
        inputs = scenario["inputs"]
        portfolio = PortfolioSnapshot(**inputs["portfolio_snapshot"])
        market_data = MarketDataSnapshot(**inputs["market_data_snapshot"])
        model = ModelPortfolio(**inputs["model_portfolio"])
        shelf = [ShelfEntry(**s) for s in inputs["shelf_entries"]]
        options = EngineOptions(**inputs["options"])
    
        if "error" in scenario["expected_outputs"]:
            with pytest.raises(ValueError, match=scenario["expected_outputs"]["error"]):
                run_simulation(portfolio, market_data, model, shelf, options)
        else:
            result = run_simulation(portfolio, market_data, model, shelf, options)
            expected = scenario["expected_outputs"]
    
            assert result.status == expected["status"]
            assert len(result.intents) == len(expected["intents"])
    
            for act_intent, exp_intent in zip(result.intents, expected["intents"]):
>               assert act_intent.side == exp_intent["side"]

tests\test_golden_scenarios.py:46: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = FxSpotIntent(intent_type='FX_SPOT', intent_id='oi_fx_3', pair='USD/SGD', buy_currency='SGD', buy_amount=Decimal('15000...', sell_amount_estimated=Decimal('10000.0'), dependencies=[], rationale=IntentRationale(code='SWEEP', message='Sweep'))
item = 'side'

    def __getattr__(self, item: str) -> Any:
        private_attributes = object.__getattribute__(self, '__private_attributes__')
        if item in private_attributes:
            attribute = private_attributes[item]
            if hasattr(attribute, '__get__'):
                return attribute.__get__(self, type(self))  # type: ignore
    
            try:
                # Note: self.__pydantic_private__ cannot be None if self.__private_attributes__ has items
                return self.__pydantic_private__[item]  # type: ignore
            except KeyError as exc:
                raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc
        else:
            # `__pydantic_extra__` can fail to be set if the model is not yet fully initialized.
            # See `BaseModel.__repr_args__` for more details
            try:
                pydantic_extra = object.__getattribute__(self, '__pydantic_extra__')
            except AttributeError:
                pydantic_extra = None
    
            if pydantic_extra is not None:
                try:
                    return pydantic_extra[item]
                except KeyError as exc:
                    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc
            else:
                if hasattr(self.__class__, item):
                    return super().__getattribute__(item)  # Raises AttributeError if appropriate
                else:
                    # this is the current error
>                   raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
E                   AttributeError: 'FxSpotIntent' object has no attribute 'side'

venv\Lib\site-packages\pydantic\main.py:767: AttributeError
_____ test_golden_scenario[scenario_113_capped_rotation.json-scenario16] ______

filename = 'scenario_113_capped_rotation.json'
scenario = {'expected_outputs': {'after_simulated': {'allocation': [{'key': 'USD_OLD', 'value': {'amount': '0.00', 'currency': 'S...ment_id': 'USD_OLD', 'market_value': None, 'quantity': '100'}]}, ...}, 'scenario_name': 'scenario_113_capped_rotation'}

    @pytest.mark.parametrize("filename, scenario", load_golden_scenarios())
    def test_golden_scenario(filename, scenario):
        inputs = scenario["inputs"]
        portfolio = PortfolioSnapshot(**inputs["portfolio_snapshot"])
        market_data = MarketDataSnapshot(**inputs["market_data_snapshot"])
        model = ModelPortfolio(**inputs["model_portfolio"])
        shelf = [ShelfEntry(**s) for s in inputs["shelf_entries"]]
        options = EngineOptions(**inputs["options"])
    
        if "error" in scenario["expected_outputs"]:
            with pytest.raises(ValueError, match=scenario["expected_outputs"]["error"]):
                run_simulation(portfolio, market_data, model, shelf, options)
        else:
            result = run_simulation(portfolio, market_data, model, shelf, options)
            expected = scenario["expected_outputs"]
    
            assert result.status == expected["status"]
            assert len(result.intents) == len(expected["intents"])
    
            for act_intent, exp_intent in zip(result.intents, expected["intents"]):
>               assert act_intent.side == exp_intent["side"]

tests\test_golden_scenarios.py:46: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = FxSpotIntent(intent_type='FX_SPOT', intent_id='oi_fx_4', pair='USD/SGD', buy_currency='SGD', buy_amount=Decimal('10500...D', sell_amount_estimated=Decimal('7000.0'), dependencies=[], rationale=IntentRationale(code='SWEEP', message='Sweep'))
item = 'side'

    def __getattr__(self, item: str) -> Any:
        private_attributes = object.__getattribute__(self, '__private_attributes__')
        if item in private_attributes:
            attribute = private_attributes[item]
            if hasattr(attribute, '__get__'):
                return attribute.__get__(self, type(self))  # type: ignore
    
            try:
                # Note: self.__pydantic_private__ cannot be None if self.__private_attributes__ has items
                return self.__pydantic_private__[item]  # type: ignore
            except KeyError as exc:
                raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc
        else:
            # `__pydantic_extra__` can fail to be set if the model is not yet fully initialized.
            # See `BaseModel.__repr_args__` for more details
            try:
                pydantic_extra = object.__getattribute__(self, '__pydantic_extra__')
            except AttributeError:
                pydantic_extra = None
    
            if pydantic_extra is not None:
                try:
                    return pydantic_extra[item]
                except KeyError as exc:
                    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc
            else:
                if hasattr(self.__class__, item):
                    return super().__getattribute__(item)  # Raises AttributeError if appropriate
                else:
                    # this is the current error
>                   raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
E                   AttributeError: 'FxSpotIntent' object has no attribute 'side'

venv\Lib\site-packages\pydantic\main.py:767: AttributeError
______ test_golden_scenario[scenario_303_multi_currency.json-scenario20] ______

filename = 'scenario_303_multi_currency.json'
scenario = {'expected_outputs': {'after_simulated': {'allocation': [{'key': 'CASH', 'value': {'amount': '5005.000000', 'currency'...e, 'settled': None}], 'portfolio_id': 'pf_303', 'positions': []}, ...}, 'scenario_name': 'scenario_303_multi_currency'}

    @pytest.mark.parametrize("filename, scenario", load_golden_scenarios())
    def test_golden_scenario(filename, scenario):
        inputs = scenario["inputs"]
        portfolio = PortfolioSnapshot(**inputs["portfolio_snapshot"])
        market_data = MarketDataSnapshot(**inputs["market_data_snapshot"])
        model = ModelPortfolio(**inputs["model_portfolio"])
        shelf = [ShelfEntry(**s) for s in inputs["shelf_entries"]]
        options = EngineOptions(**inputs["options"])
    
        if "error" in scenario["expected_outputs"]:
            with pytest.raises(ValueError, match=scenario["expected_outputs"]["error"]):
                run_simulation(portfolio, market_data, model, shelf, options)
        else:
            result = run_simulation(portfolio, market_data, model, shelf, options)
            expected = scenario["expected_outputs"]
    
            assert result.status == expected["status"]
            assert len(result.intents) == len(expected["intents"])
    
            for act_intent, exp_intent in zip(result.intents, expected["intents"]):
>               assert act_intent.side == exp_intent["side"]

tests\test_golden_scenarios.py:46: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = FxSpotIntent(intent_type='FX_SPOT', intent_id='oi_fx_2', pair='USD/SGD', buy_currency='USD', buy_amount=Decimal('3737....ell_amount_estimated=Decimal('5044.95000'), dependencies=[], rationale=IntentRationale(code='FUNDING', message='Fund'))
item = 'side'

    def __getattr__(self, item: str) -> Any:
        private_attributes = object.__getattribute__(self, '__private_attributes__')
        if item in private_attributes:
            attribute = private_attributes[item]
            if hasattr(attribute, '__get__'):
                return attribute.__get__(self, type(self))  # type: ignore
    
            try:
                # Note: self.__pydantic_private__ cannot be None if self.__private_attributes__ has items
                return self.__pydantic_private__[item]  # type: ignore
            except KeyError as exc:
                raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc
        else:
            # `__pydantic_extra__` can fail to be set if the model is not yet fully initialized.
            # See `BaseModel.__repr_args__` for more details
            try:
                pydantic_extra = object.__getattribute__(self, '__pydantic_extra__')
            except AttributeError:
                pydantic_extra = None
    
            if pydantic_extra is not None:
                try:
                    return pydantic_extra[item]
                except KeyError as exc:
                    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc
            else:
                if hasattr(self.__class__, item):
                    return super().__getattribute__(item)  # Raises AttributeError if appropriate
                else:
                    # this is the current error
>                   raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
E                   AttributeError: 'FxSpotIntent' object has no attribute 'side'

venv\Lib\site-packages\pydantic\main.py:767: AttributeError
_____ test_golden_scenario[scenario_304_partial_funding.json-scenario21] ______

filename = 'scenario_304_partial_funding.json'
scenario = {'expected_outputs': {'after_simulated': {'allocation': [{'key': 'CASH', 'value': {'amount': '5680.000000', 'currency'..., 'settled': None}], 'portfolio_id': 'pf_304', 'positions': []}, ...}, 'scenario_name': 'scenario_304_partial_funding'}

    @pytest.mark.parametrize("filename, scenario", load_golden_scenarios())
    def test_golden_scenario(filename, scenario):
        inputs = scenario["inputs"]
        portfolio = PortfolioSnapshot(**inputs["portfolio_snapshot"])
        market_data = MarketDataSnapshot(**inputs["market_data_snapshot"])
        model = ModelPortfolio(**inputs["model_portfolio"])
        shelf = [ShelfEntry(**s) for s in inputs["shelf_entries"]]
        options = EngineOptions(**inputs["options"])
    
        if "error" in scenario["expected_outputs"]:
            with pytest.raises(ValueError, match=scenario["expected_outputs"]["error"]):
                run_simulation(portfolio, market_data, model, shelf, options)
        else:
            result = run_simulation(portfolio, market_data, model, shelf, options)
            expected = scenario["expected_outputs"]
    
            assert result.status == expected["status"]
            assert len(result.intents) == len(expected["intents"])
    
            for act_intent, exp_intent in zip(result.intents, expected["intents"]):
>               assert act_intent.side == exp_intent["side"]

tests\test_golden_scenarios.py:46: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = FxSpotIntent(intent_type='FX_SPOT', intent_id='oi_fx_2', pair='USD/SGD', buy_currency='USD', buy_amount=Decimal('3232....ell_amount_estimated=Decimal('4363.20000'), dependencies=[], rationale=IntentRationale(code='FUNDING', message='Fund'))
item = 'side'

    def __getattr__(self, item: str) -> Any:
        private_attributes = object.__getattribute__(self, '__private_attributes__')
        if item in private_attributes:
            attribute = private_attributes[item]
            if hasattr(attribute, '__get__'):
                return attribute.__get__(self, type(self))  # type: ignore
    
            try:
                # Note: self.__pydantic_private__ cannot be None if self.__private_attributes__ has items
                return self.__pydantic_private__[item]  # type: ignore
            except KeyError as exc:
                raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc
        else:
            # `__pydantic_extra__` can fail to be set if the model is not yet fully initialized.
            # See `BaseModel.__repr_args__` for more details
            try:
                pydantic_extra = object.__getattribute__(self, '__pydantic_extra__')
            except AttributeError:
                pydantic_extra = None
    
            if pydantic_extra is not None:
                try:
                    return pydantic_extra[item]
                except KeyError as exc:
                    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}') from exc
            else:
                if hasattr(self.__class__, item):
                    return super().__getattribute__(item)  # Raises AttributeError if appropriate
                else:
                    # this is the current error
>                   raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
E                   AttributeError: 'FxSpotIntent' object has no attribute 'side'

venv\Lib\site-packages\pydantic\main.py:767: AttributeError
============================== warnings summary ===============================
venv\Lib\site-packages\pydantic\_internal\_fields.py:151
  C:\Users\sande\dev\dpm-rebalance-engine\venv\Lib\site-packages\pydantic\_internal\_fields.py:151: UserWarning: Field "model_portfolio" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

venv\Lib\site-packages\httpx\_client.py:680
  C:\Users\sande\dev\dpm-rebalance-engine\venv\Lib\site-packages\httpx\_client.py:680: DeprecationWarning: The 'app' shortcut is now deprecated. Use the explicit style 'transport=WSGITransport(app=...)' instead.
    warnings.warn(message, DeprecationWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED tests/test_dependencies.py::test_dependency_multi_leg_chain - Attribut...
FAILED tests/test_engine_core.py::test_target_normalization_over_100 - Assert...
FAILED tests/test_golden_scenarios.py::test_golden_scenario[scenario_03_fx_funding.json-scenario2]
FAILED tests/test_golden_scenarios.py::test_golden_scenario[scenario_104_multicurrency_fx.json-scenario10]
FAILED tests/test_golden_scenarios.py::test_golden_scenario[scenario_112_cross_currency_switch.json-scenario15]
FAILED tests/test_golden_scenarios.py::test_golden_scenario[scenario_113_capped_rotation.json-scenario16]
FAILED tests/test_golden_scenarios.py::test_golden_scenario[scenario_303_multi_currency.json-scenario20]
FAILED tests/test_golden_scenarios.py::test_golden_scenario[scenario_304_partial_funding.json-scenario21]
8 failed, 61 passed, 2 warnings in 0.41s
